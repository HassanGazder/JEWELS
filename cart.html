<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
  <link rel="stylesheet" href="index.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">JEWELZ</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="shop.html">Shop</a>
          </li>
        </ul>
        <form class="d-flex">
          <a href="cart.html" class="fa fa-shopping-cart cart-icon">
              <span class='badge badge-warning' id='CartCount'>0</span>
          </a>
      </form>
      </div>
    </div>
  </nav>
  <!-- <div id="navbar">
    <a class="navbar-brand">OnlineShop
      <img src="https://www.pngitem.com/pimgs/m/178-1783030_online-shopping-logo-png-transparent-png.png" width="50px"
        height="50px" alt="" />
    </a>
    <a href="index.html">Home</a>
    <a href="#">About</a>
    <a href="shop.html">Shop Online</a>
    <a href="#">Contact</a>
    <a href="cart.html" class="fa fa-shopping-cart cart-icon">
      <span class='badge badge-warning' id='CartCount'>0</span>
    </a>
  </div> -->

  <h1 class="text-center">Your Cart</h1>
  <div id="emptyalert" class="alert alert-danger w-50 text-center m-0 m-auto mt-3" role="alert">
    Your Cart Was Empty <a href="shop.html">Click</a>To Add Items
  </div>
  <div id="parentdiv">
    <div id="productinformation"></div>
    <div id="yourtotal">
      <h4 id="quantity"></h4>
      <h4 id="total"></h4>
    </div>
  </div>
  <script>
    let Cart = localStorage.getItem("Products");
    let result = JSON.parse(Cart);
    // let emptyalert = document.getElementById("emptyalert");
    // emptyalert.style.display = "none";

    let cartcounter = document.getElementById("CartCount");
    function cartcount(items) {
      cartcounter.innerText = items.reduce((acc, curr) => {
        return acc + curr.productquantity;
      }, 0);
    }
    cartcount(result);

    let emptyalert = document.getElementById("emptyalert");
      emptyalert.style.display = "none";
    


    let totalQuantity = 0;
    let totalPrice = 0;
    for (let i = 0; i < result.length; i++) {
      let yourtotal = document.getElementById("yourtotal");
      let parentdiv = document.getElementById("parentdiv");
      parentdiv.style.backgroundColor = "#2980b9";
      let productinformation = document.getElementById("productinformation");
      let div = document.createElement("div");
      div.style.textAlign = "center";
      let productimg = document.createElement("img");
      productimg.src = result[i].productimage;
      productimg.className = "cartimages";

      let productname = document.createElement("p");
      productname.innerText = result[i].productname;
      productname.style.color = "white";
      productname.style.fontWeight = "bold";

      let productprice = document.createElement("p");
      productprice.innerText = result[i].productprice;
      productprice.style.color = "white";
      productprice.style.fontWeight = "bold";
      totalPrice += result[i].productprice * result[i].productquantity;
      // quantities plus and minus

      let QuantitiesDiv = document.createElement("div");
      let Quantityminus = document.createElement("button");
      Quantityminus.setAttribute("class", "btn btn-danger");
      Quantityminus.textContent = "-";
      Quantityminus.addEventListener("click", () => {
        QuantityDecrement(i);
      });
      let Quantitylabel = document.createElement("label");
      Quantitylabel.innerText = result[i].productquantity;
      Quantitylabel.style.backgroundColor = "white"
      Quantitylabel.style.width = "30%";
      Quantitylabel.style.height = "30px";
      let QuantityPlus = document.createElement("button");
      QuantityPlus.setAttribute("class", "btn btn-danger");
      QuantityPlus.addEventListener("click", () => {
        QuantityIncrement(i);
      });
      QuantityPlus.textContent = "+";
      totalQuantity += result[i].productquantity;

      QuantitiesDiv.append(Quantityminus);
      QuantitiesDiv.append(Quantitylabel);
      QuantitiesDiv.append(QuantityPlus);

      div.append(productimg);
      div.append(productname);
      div.append(productprice);
      div.append(QuantitiesDiv);
      productinformation.append(div);
      // quantity increment function
      function QuantityIncrement(index) {
        Quantity.innerText = "Quantity:" + ++totalQuantity
        Quantitylabel.innerText++
        result[index].productquantity++;
        totalPrice = result[index].productprice + totalPrice;
        Total.innerText = "Total:" + totalPrice;
        localStorage.setItem("Products", JSON.stringify(result));
        cartcount(result);
      }
      // quantity increment function

      // quantity decrement function

      function QuantityDecrement(index) {
        Quantity.innerText = "Quantity:" + --totalQuantity
        Quantitylabel.innerText--;
        result[index].productquantity--;
        totalPrice = Math.abs(totalPrice) - result[index].productprice;
        Total.innerText = "Total:" + totalPrice;
        localStorage.setItem("Products", JSON.stringify(result));
        cartcount(result);

        console.log(productinformation)

        if (Total.innerText == 0 || totalQuantity == 0) {
          localStorage.clear();
          console.log("removed");
          parentdiv.remove();
          parentdiv.style.display = "none"
          emptyalert.style.display = "block";
          return
        }



        const output = result.filter((x) => x.productquantity > 0)
        console.log(output);
        localStorage.setItem("Products", JSON.stringify(output));

        if (result[index].productquantity == 0) {
          div.remove();
        }
      }
    }

    let Quantity = document.getElementById("quantity");
    Quantity.innerText = "Quantity:" + totalQuantity;
    let Total = document.getElementById("total");
    Total.innerText = "Total:" + totalPrice;

  </script>

  <!-- <script src="index.js"></script>  -->
</body>

</html>